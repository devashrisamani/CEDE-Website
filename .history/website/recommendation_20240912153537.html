<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recommendation</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <style>
      #wrapper {
        width: 100%;
        text-align: center;
      }

      .header-title {
        margin-top: 20px;
        margin-bottom: 20px;
        text-align: left;
      }

      .recommendation-section {
        padding: 20px;
        border-radius: 5px;
        margin-bottom: 15px;
      }

      .high-probability {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
      }

      .caution {
        background-color: #fff3cd;
        border: 1px solid #ffeeba;
      }

      .low-probability {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
      }

      .btn-container-wrapper {
        display: flex;
        justify-content: center;
        width: 100%;
      }

      .btn-container {
        position: fixed;
        bottom: 0;
        width: 100%;
        background-color: white;
        padding: 10px 0;
        display: flex;
        justify-content: center;
        border-top: 1px solid #cfcfcf;
        z-index: 1000;
      }

      .btn-container .btn {
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 30px;
        border: 2px solid #007bff;
        background-color: white;
        color: #007bff;
        text-transform: uppercase;
        margin-right: 20px;
      }

      .btn-container .btn:last-child {
        margin-right: 0;
      }

      .btn-container .btn:hover {
        background-color: #e0e0e0;
        color: #007bff;
      }

      .card-body {
        text-align: left;
        color: black;
      }

      .card-header .btn-link {
        text-align: left;
        width: 100%;
        text-decoration: none;
        color: black;
      }

      .container {
        padding-bottom: 80px; /* to ensure the content does not hide behind the fixed button */
      }

      .accordion-button:not(.collapsed) {
        color: #007bff;
        background-color: #e0f3ff; /* Updated to light blue color */
      }

      .accordion-button {
        text-decoration: none;
      }

      .accordion-body {
        padding-left: 40px; /* Indent the text */
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-white">
      <div class="container-fluid">
        <a class="navbar-brand" href="index.html">CEDE</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNavAltMarkup"
          aria-controls="navbarNavAltMarkup"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse justify-content-end"
          id="navbarNavAltMarkup"
        >
          <div class="navbar-nav">
            <a class="nav-link" href="index.html">Home</a>
            <div class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="matrixSelectionDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Matrix Selection
              </a>
              <ul
                class="dropdown-menu"
                aria-labelledby="matrixSelectionDropdown"
              >
                <li>
                  <a class="dropdown-item" href="amplitude.html"
                    >Amplitude Normalization</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#">Electrode Selection</a>
                </li>
                <li><a class="dropdown-item" href="#">Terminology</a></li>
                <li>
                  <a class="dropdown-item" href="#"
                    >High-density surface electromyograph</a
                  >
                </li>
                <li><a class="dropdown-item" href="#">Single Motor Unit</a></li>
              </ul>
            </div>
            <a class="nav-link" href="faq.html">FAQs</a>
            <a class="nav-link" href="#">Glossary</a>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-5 px-5">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="index.html">Matrix Selection</a>
          </li>
          <li class="breadcrumb-item">
            <a href="amplitude.html">Amplitude Normalization</a>
          </li>
          <li class="breadcrumb-item">
            <a href="inttool.html">Interactive Tool</a>
          </li>
          <li class="breadcrumb-item">
            <a href="collectdata.html">Collect Data</a>
          </li>
          <!-- <li class="breadcrumb-item">
            <a href="collectdata.html">Amplitude Features</a>
          </li> -->
          <li class="breadcrumb-item active" aria-current="page">
            Recommendation
          </li>
        </ol>
      </nav>

      <div class="header-title">
        <h2>Recommendation</h2>
        <p>
          Based on the options you selected, these are the recommendations for
          the experimental context:
        </p>
        <p>
          <strong id="recommendation-text">
            <!-- Recommendation will be displayed here -->
          </strong>
        </p>
        <p>
          Sourced from the paper
          <a href="https://pubmed.ncbi.nlm.nih.gov/32569878/" target="_blank"
            >Besomi et al. 2020</a
          >.
        </p>
        <p>
          It is suggested to use the most stringent method below. Expand a
          method to learn more.
        </p>
      </div>

      <div class="recommendation-section high-probability">
        <h4>
          <i class="fa fa-check-circle" aria-hidden="true"></i> Yes: High
          probability that this is appropriate
        </h4>
        <div id="high-probability-methods" class="accordion"></div>
      </div>

      <div class="recommendation-section caution">
        <h4>
          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Caution:
          Might be appropriate, considering specific issues
        </h4>
        <div id="caution-methods" class="accordion"></div>
      </div>

      <div class="recommendation-section low-probability">
        <h4>
          <i class="fa fa-times-circle" aria-hidden="true"></i> No: High
          probability that this is inappropriate
        </h4>
        <div id="low-probability-methods" class="accordion"></div>
      </div>

      <div class="btn-container-wrapper">
        <div class="btn-container">
          <button class="btn" onclick="location.href='index.html'">
            Select a New Matrix
          </button>
          <button class="btn" onclick="location.href='collectdata.html'">
            Collect More Data
          </button>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Fetch the recommendation from localStorage
        const recommendation = localStorage.getItem("recommendation");

        console.log(
          "Fetched recommendation from localStorage:",
          recommendation
        ); // Debug step

        // Example methods data
        const methodsData = {
          "Experimental context 1: Amplitude comparison within a person and muscle, between conditions/ tasks (within a session*).":
            {
              high: [
                {
                  title:
                    "Normalization to the maximum voluntary contraction (MVC) in the same task/context as the task of interest (with matched contraction type*, muscle length/joint angle, and/or velocity) *isometric; concentric; eccentric.",
                  content:
                    'Normalizing to maximum voluntary contraction (MVC) provides a relative value useful to compare the magnitude of muscle activity in different tasks or conditions. This represents the activity as a proportion of the maximum capacity of the muscle, as long as the normalization contraction is collected in the same position, velocity, and contraction types as the task of interest. <a href="method.html">See More</a>',
                },
                {
                  title:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) when it is not possible to match all aspects of the task of interest (e.g., multiple tasks or muscles investigated, complex task).",
                  content: "Additional information about this method.",
                },
                {
                  title:
                    "Normalization to the peak or mean EMG amplitude during the task investigated. For comparisons between conditions (e.g., pre-post intervention in a single session) for a single task (e.g., running).",
                  content: "Additional information about this method.",
                },
                {
                  title: "Non-normalized EMG amplitude.",
                  content: "Additional information about this method.",
                },
              ],
              caution: [
                {
                  title:
                    "Normalization to a standardized submaximal task (isometric/dynamic) that has similar characteristics to the task of interest.",
                  content: "Additional information about this method.",
                },
                {
                  title:
                    "Normalization to the peak or mean EMG amplitude during the task investigated. For comparisons between tasks (e.g., walking vs. running).",
                  content: "Additional information about this method.",
                },
              ],
              low: [
                {
                  title: "Normalized to the maximal M-wave amplitude.",
                  content: "Additional information about this method.",
                },
              ],
            },
          "Experimental context 2: Amplitude comparison within a person and muscle, between sessions (i.e. re-application of electrodes).":
            {
              high: [
                {
                  title:
                    "Normalization to the peak or mean value of the maximum voluntary contraction (MVC) in the same task/context as the task of interest (with matched contraction type*, muscle length/joint angle, and/or velocity) *isometric; concentric; eccentric",
                  content:
                    "Normalizing to maximum voluntary contraction (MVC) provides a relative value useful to compare the magnitude of muscle activity between sessions. Between-session repeatability is likely to be achievable as long as the MVC performance is consistent across sessions. If the MVC effort varies between sessions (e.g., because of training, sleep, and nutrition), values will be normalized to different reference values, and you will be comparing apples with oranges.",
                },
                {
                  title:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) when it is not possible to match all aspects of the task of interest (e.g., multiple tasks or muscles investigated, complex task).",
                  content:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) provides a relative value useful to compare the magnitude of muscle activity between sessions. Between-session repeatability is likely to be achievable as long as the MVC performance is consistent across sessions. If the MVC effort varies between sessions (e.g., because of training, sleep, and nutrition), values will be normalized to different reference values, and you will be comparing apples with oranges.",
                },
              ],
              caution: [
                {
                  title:
                    "Normalization to a standardized submaximal task (isometric/ dynamic) that has similar characteristics to the task of interest.",
                  content:
                    "Normalization to a standardized submaximal task can be problematic when trying to compare the EMG amplitude between sessions because when a task is performed at submaximal levels, it might be performed differently between sessions, and the physiological interpretation of the reference value is unclear (e.g., it could be 10% or 100% of MVC).",
                },
                {
                  title: "Non-normalized EMG amplitude",
                  content:
                    "Non-normalized EMG amplitude should not be used to compare the amplitude of the EMG signal between sessions. Differences in electrode placement/ orientation relative to the muscle between sessions will influence EMG amplitude, in a manner that is not possible to quantify. This method might be appropriate in some contexts when using high-density surface EMG recordings (see “General considerations for normalization”). During MVC efforts (as the task of interest), it might be the only option to interpret changes in EMG amplitude between sessions, because other normalization methods (such as normalization to MVC) would remove any difference. If an MVC effort cannot be performed reliably, this method could be considered with consideration of the cautions for interpretation.",
                },
              ],
              low: [
                {
                  title:
                    "Normalization to the peak or mean EMG amplitude during the task investigated.",
                  content:
                    "Normalization to the peak or mean during task is not appropriate for comparison between sessions. By normalizing to the peak/mean during the task investigated, data in each session is scaled to 100%, which will remove any differences in amplitude between sessions.",
                },
                {
                  title: "Normalized to the maximal M-wave amplitude.",
                  content:
                    "Generally, normalization to the maximal M-wave amplitude is only used for normalization of evoked potentials (i.e., motor evoked potentials (MEP) or Hoffman reflex (H-reflex) / <alternative: hyperlink on definitions>.",
                },
              ],
            },
          "Experimental context 3: Amplitude comparison between muscles during the same task (same muscle in different participants; or different muscles in the same participant).":
            {
              high: [
                {
                  title:
                    "Normalization to the maximum voluntary contraction (MVC) in the same task/context as the task of interest (with matched contraction type*, muscle length/joint angle, and/or velocity) *isometric; concentric; eccentric",
                  content:
                    "Normalization to the maximum voluntary contraction (MVC) provides a relative value that can be related to the maximal activation of each muscle, and therefore allows for comparison between muscles (within a person) or within a muscle (between participants). This method is valid also for between-session comparisons, as long as the MVC amplitude does not vary between sessions.",
                },
                {
                  title:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) when it is not possible to match all aspects of the task of interest (e.g., multiple tasks or muscles investigated, complex task).",
                  content:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) provides a relative value useful to compare the EMG amplitude of different muscles within a person or the same muscle between participants. This method is less ideal than “normalization to the MVC in the same task/context as the task of interest” because it DOES NOT control for physiological and anatomical issues (e.g., contraction type, muscle architecture, electrode placement, etc.).",
                },
              ],
              caution: [
                {
                  title: "Normalized to the maximal M-wave amplitude.",
                  content:
                    "Generally, normalization to the maximal M-wave amplitude is only used for normalization of evoked potentials (i.e., motor evoked potentials (MEP) or Hoffman reflex (H-reflex)).",
                },
              ],
              low: [
                {
                  title:
                    "Normalization to peak or mean of a standardized submaximal task (isometric/ dynamic) that has similar characteristics to the task of interest.",
                  content:
                    "Normalization to a standardized submaximal task should not be used to compare the amplitude of the EMG signal between muscles or participants. The contribution of each muscle to a submaximal task is unlikely to be equivalent between muscles (e.g., deltoid vs supraspinatus during shoulder abduction) or groups (e.g., deltoid muscle between healthy pain-free individuals and participants with shoulder replacement; or males vs females with different relative weights of their arms), thus the reference value for each muscle will not be standardized, and therefore, it is not possible to accurately interpret the comparison.",
                },
                {
                  title:
                    "Normalization to the peak or mean EMG amplitude during the task investigated.",
                  content:
                    "Normalization to the peak or mean EMG amplitude during the task is not a valid method to compare between muscles or participants, because differences in EMG amplitude between muscles are intentionally removed by the normalization method. It is not valid for between-session comparisons.",
                },
                {
                  title: "Non-normalized EMG amplitude.",
                  content:
                    "Non-normalized EMG amplitude should not be used to compare the amplitude of the EMG signal between muscles or participants, because electrode and anatomical issues cannot be perfectly matched or controlled. For example, orientation relative to the muscle fibers, anatomical differences (such as the thickness of subcutaneous tissue) or muscle architectural characteristics (such as fiber types, or fiber cross-sectional area) might lead to systematic biases when comparing muscle amplitude between muscles. This method should only be considered to increase the confidence of the interpretation of another method.",
                },
              ],
            },
          "Experimental context 5: Identification of periods of activity and inactivity using thresholds based on signal amplitude for comparison between muscles/groups.":
            {
              high: [],
              caution: [
                {
                  title: "Non-normalised EMG amplitude.",
                  content:
                    "For the identification of periods of activity or inactivity based on EMG amplitude thresholds Non-normalised EMG amplitude is not appropriate. As the amplitude of the EMG will likely differ between muscles/ groups this will influence the threshold that is set (when periods of activity/ inactivity are identified from values as a proportion of a specific EMG amplitude). If the non-normalised value is used as the threshold, muscles with low amplitude will have a bias towards earlier identification of activity than a muscle that is activated to a high EMG amplitude during the task. Note that an alternative approach to identifying periods of activity of non-normalised EMG amplitude would be identifying the onset as the value corresponding to 2–3 standard deviations above the baseline recording if sustained for a specified number of milliseconds.",
                },
              ],
              low: [
                {
                  title:
                    "Normalisation to a standardised submaximal task (isometric/ dynamic) that can be task-specific or non-task-specific.",
                  content:
                    "Normalisation to a standardised submaximal task is not appropriate for the identification of periods of activity or inactivity based on EMG amplitude thresholds. If activation in the submaximal task differs between muscles/groups, this will influence the threshold that is set.",
                },
                {
                  title:
                    "Normalisation to the peak or mean EMG amplitude throughout the task investigated.",
                  content:
                    "Normalisation to the peak or mean EMG amplitude is not appropriate for the identification of periods of activity or inactivity based on EMG amplitude thresholds. If the percentage of peak/ average value is used as the threshold, muscles with low amplitude will have a bias towards earlier identification of activity than a muscle that is activated to a high EMG amplitude during the task.",
                },
                {
                  title: "Non-normalized EMG amplitude.",
                  content:
                    "Non-normalized EMG amplitude should not be used to compare the amplitude of the EMG signal between muscles or participants, because electrode and anatomical issues cannot be perfectly matched or controlled. For example, orientation relative to the muscle fibers, anatomical differences (such as the thickness of subcutaneous tissue) or muscle architectural characteristics (such as fiber types, or fiber cross-sectional area) might lead to systematic biases when comparing muscle amplitude between muscles. This method should only be considered to increase the confidence of the interpretation of another method.",
                },
              ],
            },

          "Experimental context 6: Identification of pattern* of activation from averaged data for comparison between muscles/groups/trials.":
            {
              high: [
                {
                  title:
                    "Normalisation to the maximum voluntary contraction (MVC) in the same task/context as the task of interest (with matched contraction type*, muscle length/joint angle, and/or velocity) *isometric; concentric; eccentric",
                  content:
                    'Normalisation to the maximum voluntary contraction (MVC) is appropriate when identifying periods of activity or inactivity based on EMG amplitude thresholds. The physiological meaning of the threshold (i.e., percentage of MVC) for onset of EMG will be consistent between muscles and participant groups as long as a true maximum contraction is performed. Caution if a different level of activation is achieved for different muscles during the attempted MVC. This is very difficult to detect but would normally require superimposed twitch interpolation [hyperlink with explanation of concept]. This would be clear if the normalised amplitude exceeds 100%. <a href="method.html">See More</a>',
                },
                {
                  title:
                    "Normalisation to a standardised isometric MVC when it is not possible to match the outcome contraction (e.g., multiple tasks or muscles investigated).",
                  content:
                    "Although normalisation to a standardised isometric MVC is appropriate when identifying periods of activity or inactivity based on EMG amplitude thresholds, this method is less ideal than Normalisation to the maximum voluntary contraction (MVC) in the same task/context as the task of interest [hyperlink to method 5.1], because it DOES NOT control for physiological and anatomical differences (e.g., contraction type, contraction type, speed, muscle length or relative position between electrodes and muscle fibres, muscle architecture [e.g., pennation angle, fibres curvature],  etc.) between the task of interested and the MVC task. The physiological meaning of the threshold (i.e., percentage of MVC) for onset identification of the EMG signal will be consistent between muscles and participant groups as long as a true maximum contraction is performed. Caution if different levels of activation are achieved for different muscles during the attempted MVC.",
                },
              ],
              caution: [
                {
                  title:
                    "Normalisation to the maximum voluntary contraction (MVC) in the same task/context as the task of interest (with matched contraction type*, muscle length/joint angle, and/or velocity) *isometric; concentric; eccentric.",
                  content:
                    "Although normalisation to the maximum voluntary contraction (MVC) allows the identification of patterns of activation from averaged data, this method requires considerations. The effect of normalisation on MVC is that EMG traces with normalised values that are a greater proportion of MVC would contribute more to the ensemble average (and converse).",
                },
                {
                  title:
                    "Normalisation to a standardised isometric MVC when it is not possible to match the outcome contraction (e.g., multiple tasks or muscles investigated).",
                  content:
                    "Although normalisation to the maximum voluntary contraction (MVC) allows the identification of patterns of activation from averaged data, this method requires considerations, and is less ideal than Normalisation to the maximum voluntary contraction (MVC) in the same task/context as the task of interest, because interest [hyperlink to method 6.1], because it DOES NOT control for physiological and anatomical issues (e.g., contraction type, muscle architecture [which changes with contraction], position of electrode relative to the muscle [particularly relevant for tasks when the muscle is moving], etc.). The effect of normalisation on MVC is that EMG traces with normalised values that are a greater proportion of MVC would contribute more to the ensemble average (and converse).",
                },
                {
                  title:
                    "Normalisation to the peak or mean EMG amplitude throughout the task investigated.",
                  content:
                    "Although Normalisation to the peak or mean EMG amplitude throughout the task investigated allows the identification of patterns of activation from averaged data, this method requires consideration. Normalisation to peak results in equal weighting of each muscle/participant to the average. One limitation of this approach is that EMG signals that are very low in amplitude (e.g. due to a low level of muscle activation or poor quality of EMG recordings), if normalised to their peak value during the task, will incorrectly appear to be very active throughout.",
                },
              ],
              low: [
                {
                  title:
                    "Normalisation to a standardised submaximal task (isometric/ dynamic) that can be task-specific or non-task-specific.",
                  content:
                    "Normalisation to a standardised submaximal task is not appropriate for the identification of patterns of activation from averaged data.  The effect of normalisation to a submaximal effort is that EMG traces with normalised values that are a greater proportion of the submaximal task would contribute more to the ensemble average (and converse), and the activation of the muscles during the submaximal task is unlikely to be equivalent between muscles and between participants. This means that the bias would differ between individuals and complicate the interpretation of the results.",
                },
                {
                  title: "Non-normalised EMG amplitude.",
                  content:
                    "Non-normalised EMG amplitude is not appropriate for the identification of patterns of activation from averaged data. When generating an ensemble average across participants the use of non-normalised data would bias the result to the muscle with the largest EMG amplitude. This bias may be caused by issues unrelated to the relative EMG amplitude because this method DOES NOT control for physiological and anatomical issues (e.g., subcutaneous fat, muscle architecture [which changes with contraction], position of electrode relative to the muscle [particularly relevant for tasks when the muscle is moving], etc.).",
                },
              ],
            },
          // Add other experimental contexts here if needed
        };

        // Function to update methods dynamically
        function updateMethods(methods, elementId) {
          const element = document.getElementById(elementId);
          element.innerHTML = methods
            .map(
              (method, index) => `
              <div class="accordion-item">
                <h2 class="accordion-header" id="${elementId}Heading${index}">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#${elementId}Collapse${index}"
                    aria-expanded="false"
                    aria-controls="${elementId}Collapse${index}"
                  >
                    ${method.title}
                  </button>
                </h2>
                <div
                  id="${elementId}Collapse${index}"
                  class="accordion-collapse collapse"
                  aria-labelledby="${elementId}Heading${index}"
                  data-bs-parent="#${elementId}"
                >
                  <div class="accordion-body">
                    <ul><li>${method.content}</li></ul>
                    <a href="method.html" class="see-more-btn" data-method-index="${index}" data-element-id="${elementId}">See More</a>
                  </div>
                </div>
              </div>
            `
            )
            .join("");

          // Add event listeners for "See More" buttons
          //   document.querySelectorAll(".see-more-btn").forEach((button) => {
          //     button.addEventListener("click", function () {
          //       const methodIndex = this.getAttribute("data-method-index");
          //       const elementId = this.getAttribute("data-element-id");

          //       // Store selected method details in localStorage, including the questions and answers
          //       const selectedMethod = methods[methodIndex];
          //       localStorage.setItem(
          //         "selectedMethod",
          //         JSON.stringify({
          //           title: selectedMethod.title,
          //           whyGoodChoice: [
          //             "MVC provides a meaningful reference – the onset/offset threshold can be interpreted with respect to the maximum capacity of that muscle in that context.",
          //             "Because the investigated task and the MVC task are the same, it is more likely that the EMG amplitude represents the true maximum muscle activation that is possible in that context, and the selected threshold will provide a valid reference value for that task.",
          //             "The threshold will be the same for all muscles investigated.",
          //             "It is likely that the maximum performance is repeatable in separate sessions.",
          //           ],
          //           caveats: [
          //             "Normalising to MVC during dynamic conditions can be challenging and sometimes shortcuts are taken, for example, this might involve performing MVC in a subset of contexts (but not all).",
          //             "Caution if a different level of activation is achieved for different muscles during the attempted MVC.",
          //             "Care must be taken in selecting the threshold of amplitude to ensure that it is meaningful.",
          //             "Some participants are potentially unable to perform a true MVC. Therefore, interpreting the results would be challenging.",
          //           ],
          //           howToDoIt: [
          //             "Conduct between 3-5 contractions that generate consistent values.",
          //             "Include adequate rest periods (1-2 minutes) that will depend on the duration of the maximal efforts.",
          //             "Ensure the participant performs a true maximum.",
          //           ],
          //         })
          //       );
          //     });
          //   });

          document.querySelectorAll(".see-more-btn").forEach((button) => {
            button.addEventListener("click", function () {
              const methodIndex = this.getAttribute("data-method-index"); // Index of selected method
              const elementId = this.getAttribute("data-element-id"); // Category (high, caution, low)

              // Correctly map the methods section (high-probability, caution, or low-probability)
              const selectedMethodsSection =
                methodsData[recommendation][elementId];

              // Ensure the correct method is fetched based on methodIndex and elementId
              const selectedMethod = selectedMethodsSection[methodIndex];

              // Now store the selected method details in localStorage
              localStorage.setItem(
                "selectedMethod",
                JSON.stringify({
                  title: selectedMethod.title, // Ensure this is correct
                  whyGoodChoice: selectedMethod.whyGoodChoice,
                  caveats: selectedMethod.caveats,
                  howToDoIt: selectedMethod.howToDoIt,
                  probability: elementId, // high-probability, caution, or low-probability
                })
              );

              // Add console.log to debug the selected method and ensure correct title is saved
              console.log("Selected Method saved to localStorage:", {
                title: selectedMethod.title,
                whyGoodChoice: selectedMethod.whyGoodChoice,
                caveats: selectedMethod.caveats,
                howToDoIt: selectedMethod.howToDoIt,
                probability: elementId,
              });
            });
          });
        }

        // Load the recommendation data into the page
        if (recommendation && methodsData[recommendation]) {
          document.getElementById("recommendation-text").innerText =
            recommendation;
          updateMethods(
            methodsData[recommendation].high,
            "high-probability-methods"
          );
          updateMethods(methodsData[recommendation].caution, "caution-methods");
          updateMethods(
            methodsData[recommendation].low,
            "low-probability-methods"
          );
        } else {
          console.log(
            "No matching recommendation found or no methods data for recommendation."
          );
          document.getElementById("recommendation-text").innerText =
            "No recommendation found.";
        }
      });
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js"></script>
  </body>
</html>
