<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recommendation</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: white;
      }

      #wrapper {
        width: 100%;
        text-align: center;
      }

      .navbar {
        border-bottom: 1px solid #cfcfcf;
      }

      .breadcrumb {
        background-color: white;
        margin-bottom: 20px;
      }

      .breadcrumb-item a {
        color: #007bff;
        text-decoration: none;
      }

      .breadcrumb-item a:hover {
        text-decoration: underline;
      }

      .header-title {
        margin-top: 20px;
        margin-bottom: 20px;
        text-align: left;
      }

      .recommendation-section {
        padding: 20px;
        border-radius: 5px;
        margin-bottom: 15px;
      }

      .high-probability {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
      }

      .caution {
        background-color: #fff3cd;
        border: 1px solid #ffeeba;
      }

      .low-probability {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
      }

      .btn-container-wrapper {
        display: flex;
        justify-content: center;
        width: 100%;
      }

      .btn-container {
        position: fixed;
        bottom: 0;
        width: 100%;
        background-color: white;
        padding: 10px 0;
        display: flex;
        justify-content: center;
        border-top: 1px solid #cfcfcf;
        z-index: 1000;
      }

      .btn-container .btn {
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 30px;
        border: 2px solid #007bff;
        background-color: white;
        color: #007bff;
        text-transform: uppercase;
        margin-right: 20px;
      }

      .btn-container .btn:last-child {
        margin-right: 0;
      }

      .btn-container .btn:hover {
        background-color: #e0e0e0;
        color: #007bff;
      }

      .card-body {
        text-align: left;
        color: black;
      }

      .card-header .btn-link {
        text-align: left;
        width: 100%;
        text-decoration: none;
        color: black;
      }

      .container {
        padding-bottom: 80px; /* to ensure the content does not hide behind the fixed button */
      }

      .accordion-button:not(.collapsed) {
        color: #007bff;
        background-color: #e0f3ff; /* Updated to light blue color */
      }

      .accordion-button {
        text-decoration: none;
      }

      .accordion-body {
        padding-left: 40px; /* Indent the text */
        background-color: ##dedede; /* Match the accordion body background color */
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-white">
      <div class="container-fluid">
        <a class="navbar-brand" href="index.html">CEDE</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNavAltMarkup"
          aria-controls="navbarNavAltMarkup"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse justify-content-end"
          id="navbarNavAltMarkup"
        >
          <div class="navbar-nav">
            <a class="nav-link" href="index.html">Home</a>
            <div class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="matrixSelectionDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Matrix Selection
              </a>
              <ul
                class="dropdown-menu"
                aria-labelledby="matrixSelectionDropdown"
              >
                <li>
                  <a class="dropdown-item" href="amplitude.html"
                    >Amplitude Normalization</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#">Electrode Selection</a>
                </li>
                <li><a class="dropdown-item" href="#">Terminology</a></li>
                <li>
                  <a class="dropdown-item" href="#"
                    >High-density surface electromyograph</a
                  >
                </li>
                <li><a class="dropdown-item" href="#">Single Motor Unit</a></li>
              </ul>
            </div>
            <a class="nav-link" href="faq.html">FAQs</a>
            <a class="nav-link" href="#">Glossary</a>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-5 px-5">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="index.html">Matrix Selection</a>
          </li>
          <li class="breadcrumb-item">
            <a href="amplitude.html">Amplitude Normalization</a>
          </li>
          <li class="breadcrumb-item">
            <a href="inttool.html">Interactive Tool</a>
          </li>
          <li class="breadcrumb-item">
            <a href="collectdata.html">Collect Data</a>
          </li>
          <li class="breadcrumb-item">
            <a href="collectdata.html">Amplitude Features</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            Recommendation
          </li>
        </ol>
      </nav>

      <div class="header-title">
        <h2>Recommendation</h2>
        <p>
          Based on the options you selected, these are the recommendations for
          the experimental context:
        </p>
        <p>
          <strong id="recommendation-text">
            <!-- Recommendation will be displayed here -->
          </strong>
        </p>
        <p>
          Sourced from the paper
          <a href="https://pubmed.ncbi.nlm.nih.gov/32569878/" target="_blank"
            >Besomi et al. 2020</a
          >.
        </p>
        <p>
          It is suggested to use the most stringent method below. Expand a
          method to learn more.
        </p>
      </div>

      <div class="recommendation-section high-probability">
        <h4>
          <i class="fa fa-check-circle" aria-hidden="true"></i> Yes: High
          probability that this is appropriate
        </h4>
        <div id="high-probability-methods" class="accordion"></div>
      </div>

      <div class="recommendation-section caution">
        <h4>
          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Caution:
          Might be appropriate, considering specific issues
        </h4>
        <div id="caution-methods" class="accordion"></div>
      </div>

      <div class="recommendation-section low-probability">
        <h4>
          <i class="fa fa-times-circle" aria-hidden="true"></i> No: High
          probability that this is inappropriate
        </h4>
        <div id="low-probability-methods" class="accordion"></div>
      </div>

      <div class="btn-container-wrapper">
        <div class="btn-container">
          <button class="btn" onclick="location.href='index.html'">
            Select a New Matrix
          </button>
          <button class="btn" onclick="location.href='collectdata.html'">
            Collect More Data
          </button>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Fetch the recommendation from localStorage
        const recommendation = localStorage.getItem("recommendation");

        console.log(
          "Fetched recommendation from localStorage:",
          recommendation
        ); // Debug step

        // Example methods data
        const methodsData = {
          "Experimental context 1: Amplitude comparison within a person and muscle, between conditions/ tasks (within a session*).":
            {
              high: [
                {
                  title:
                    "Normalization to the maximum voluntary contraction (MVC) in the same task/context as the task of interest (with matched contraction type*, muscle length/joint angle, and/or velocity) *isometric; concentric; eccentric.",
                  content:
                    'Normalizing to maximum voluntary contraction (MVC) provides a relative value useful to compare the magnitude of muscle activity in different tasks or conditions. This represents the activity as a proportion of the maximum capacity of the muscle, as long as the normalization contraction is collected in the same position, velocity, and contraction types as the task of interest. <a href="method.html">See More</a>',
                },
                {
                  title:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) when it is not possible to match all aspects of the task of interest (e.g., multiple tasks or muscles investigated, complex task).",
                  content: "Additional information about this method.",
                },
                {
                  title:
                    "Normalization to the peak or mean EMG amplitude during the task investigated. For comparisons between conditions (e.g., pre-post intervention in a single session) for a single task (e.g., running).",
                  content: "Additional information about this method.",
                },
                {
                  title: "Non-normalized EMG amplitude.",
                  content: "Additional information about this method.",
                },
              ],
              caution: [
                {
                  title:
                    "Normalization to a standardized submaximal task (isometric/dynamic) that has similar characteristics to the task of interest.",
                  content: "Additional information about this method.",
                },
                {
                  title:
                    "Normalization to the peak or mean EMG amplitude during the task investigated. For comparisons between tasks (e.g., walking vs. running).",
                  content: "Additional information about this method.",
                },
              ],
              low: [
                {
                  title: "Normalized to the maximal M-wave amplitude.",
                  content: "Additional information about this method.",
                },
              ],
            },
          "Experimental context 2: Amplitude comparison within a person and muscle, between sessions (i.e. re-application of electrodes).":
            {
              high: [
                {
                  title:
                    "Normalization to the peak or mean value of the maximum voluntary contraction (MVC) in the same task/context as the task of interest (with matched contraction type*, muscle length/joint angle, and/or velocity) *isometric; concentric; eccentric",
                  content:
                    "Normalizing to maximum voluntary contraction (MVC) provides a relative value useful to compare the magnitude of muscle activity between sessions. Between-session repeatability is likely to be achievable as long as the MVC performance is consistent across sessions. If the MVC effort varies between sessions (e.g., because of training, sleep, and nutrition), values will be normalized to different reference values, and you will be comparing apples with oranges.",
                },
                {
                  title:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) when it is not possible to match all aspects of the task of interest (e.g., multiple tasks or muscles investigated, complex task).",
                  content:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) provides a relative value useful to compare the magnitude of muscle activity between sessions. Between-session repeatability is likely to be achievable as long as the MVC performance is consistent across sessions. If the MVC effort varies between sessions (e.g., because of training, sleep, and nutrition), values will be normalized to different reference values, and you will be comparing apples with oranges.",
                },
              ],
              caution: [
                {
                  title:
                    "Normalization to a standardized submaximal task (isometric/ dynamic) that has similar characteristics to the task of interest.",
                  content:
                    "Normalization to a standardized submaximal task can be problematic when trying to compare the EMG amplitude between sessions because when a task is performed at submaximal levels, it might be performed differently between sessions, and the physiological interpretation of the reference value is unclear (e.g., it could be 10% or 100% of MVC).",
                },
                {
                  title: "Non-normalized EMG amplitude",
                  content:
                    "Non-normalized EMG amplitude should not be used to compare the amplitude of the EMG signal between sessions. Differences in electrode placement/ orientation relative to the muscle between sessions will influence EMG amplitude, in a manner that is not possible to quantify. This method might be appropriate in some contexts when using high-density surface EMG recordings (see “General considerations for normalization”). During MVC efforts (as the task of interest), it might be the only option to interpret changes in EMG amplitude between sessions, because other normalization methods (such as normalization to MVC) would remove any difference. If an MVC effort cannot be performed reliably, this method could be considered with consideration of the cautions for interpretation.",
                },
              ],
              low: [
                {
                  title:
                    "Normalization to the peak or mean EMG amplitude during the task investigated.",
                  content:
                    "Normalization to the peak or mean during task is not appropriate for comparison between sessions. By normalizing to the peak/mean during the task investigated, data in each session is scaled to 100%, which will remove any differences in amplitude between sessions.",
                },
                {
                  title: "Normalized to the maximal M-wave amplitude.",
                  content:
                    "Generally, normalization to the maximal M-wave amplitude is only used for normalization of evoked potentials (i.e., motor evoked potentials (MEP) or Hoffman reflex (H-reflex) / <alternative: hyperlink on definitions>.",
                },
              ],
            },
          "Experimental context 3: Amplitude comparison between muscles during the same task (same muscle in different participants; or different muscles in the same participant).":
            {
              high: [
                {
                  title:
                    "Normalization to the maximum voluntary contraction (MVC) in the same task/context as the task of interest (with matched contraction type*, muscle length/joint angle, and/or velocity) *isometric; concentric; eccentric",
                  content:
                    "Normalization to the maximum voluntary contraction (MVC) provides a relative value that can be related to the maximal activation of each muscle, and therefore allows for comparison between muscles (within a person) or within a muscle (between participants). This method is valid also for between-session comparisons, as long as the MVC amplitude does not vary between sessions.",
                },
                {
                  title:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) when it is not possible to match all aspects of the task of interest (e.g., multiple tasks or muscles investigated, complex task).",
                  content:
                    "Normalization to a standardized isometric maximum voluntary contraction (MVC) provides a relative value useful to compare the EMG amplitude of different muscles within a person or the same muscle between participants. This method is less ideal than “normalization to the MVC in the same task/context as the task of interest” because it DOES NOT control for physiological and anatomical issues (e.g., contraction type, muscle architecture, electrode placement, etc.).",
                },
              ],
              caution: [
                {
                  title: "Normalized to the maximal M-wave amplitude.",
                  content:
                    "Generally, normalization to the maximal M-wave amplitude is only used for normalization of evoked potentials (i.e., motor evoked potentials (MEP) or Hoffman reflex (H-reflex)).",
                },
              ],
              low: [
                {
                  title:
                    "Normalization to peak or mean of a standardized submaximal task (isometric/ dynamic) that has similar characteristics to the task of interest.",
                  content:
                    "Normalization to a standardized submaximal task should not be used to compare the amplitude of the EMG signal between muscles or participants. The contribution of each muscle to a submaximal task is unlikely to be equivalent between muscles (e.g., deltoid vs supraspinatus during shoulder abduction) or groups (e.g., deltoid muscle between healthy pain-free individuals and participants with shoulder replacement; or males vs females with different relative weights of their arms), thus the reference value for each muscle will not be standardized, and therefore, it is not possible to accurately interpret the comparison.",
                },
                {
                  title:
                    "Normalization to the peak or mean EMG amplitude during the task investigated.",
                  content:
                    "Normalization to the peak or mean EMG amplitude during the task is not a valid method to compare between muscles or participants, because differences in EMG amplitude between muscles are intentionally removed by the normalization method. It is not valid for between-session comparisons.",
                },
                {
                  title: "Non-normalized EMG amplitude.",
                  content:
                    "Non-normalized EMG amplitude should not be used to compare the amplitude of the EMG signal between muscles or participants, because electrode and anatomical issues cannot be perfectly matched or controlled. For example, orientation relative to the muscle fibers, anatomical differences (such as the thickness of subcutaneous tissue) or muscle architectural characteristics (such as fiber types, or fiber cross-sectional area) might lead to systematic biases when comparing muscle amplitude between muscles. This method should only be considered to increase the confidence of the interpretation of another method.",
                },
              ],
            },
          // Add other experimental contexts here if needed
        };

        function updateMethods(methods, elementId) {
          const element = document.getElementById(elementId);
          element.innerHTML = methods
            .map(
              (method, index) => `
                <div class="accordion-item">
                  <h2 class="accordion-header" id="${elementId}Heading${index}">
                    <button
                      class="accordion-button collapsed"
                      type="button"
                      data-bs-toggle="collapse"
                      data-bs-target="#${elementId}Collapse${index}"
                      aria-expanded="false"
                      aria-controls="${elementId}Collapse${index}"
                    >
                      ${method.title}
                    </button>
                  </h2>
                  <div
                    id="${elementId}Collapse${index}"
                    class="accordion-collapse collapse"
                    aria-labelledby="${elementId}Heading${index}"
                    data-bs-parent="#${elementId}"
                  >
                    <div class="accordion-body">
                      ${method.content}
                    </div>
                  </div>
                </div>
              `
            )
            .join("");
        }

        if (recommendation && methodsData[recommendation]) {
          document.getElementById("recommendation-text").innerText =
            recommendation;
          updateMethods(
            methodsData[recommendation].high,
            "high-probability-methods"
          );
          updateMethods(methodsData[recommendation].caution, "caution-methods");
          updateMethods(
            methodsData[recommendation].low,
            "low-probability-methods"
          );
        } else {
          console.log(
            "No matching recommendation found or no methods data for recommendation."
          ); // Debug step
          document.getElementById("recommendation-text").innerText =
            "No recommendation found.";
        }
      });
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js"></script>
  </body>
</html>
